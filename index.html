<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Jeu Coquin â€” Stable</title>
<link rel="manifest" href="manifest.json">
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#0b0b0b;color:#f5efef;margin:0;padding:16px;}
h1{color:#ff6aa6;margin:8px 0;text-align:center;}
.section{margin:10px 0;}
.card{background:linear-gradient(180deg,#161616,#0f0f0f);border-radius:14px;padding:18px;margin:12px auto;max-width:560px;box-shadow:0 8px 24px rgba(0,0,0,0.6);}
.icon{font-size:36px;margin-bottom:8px;}
button{display:block;width:92%;margin:10px auto;padding:12px;border-radius:12px;border:none;background:#ff6aa6;color:white;font-size:16px;}
input,textarea,select{width:92%;padding:10px;border-radius:10px;border:none;margin:8px auto;display:block;font-size:15px;}
#message{text-align:center;margin-top:8px;color:#9ff;}
.footer{font-size:12px;color:#bbb;text-align:center;margin-top:12px;}
</style>
</head>
<body>
<h1>Jeu Coquin â€” Stable</h1>

<div id="setup" class="section card">
  <h2>Entrez les pseudos (un par ligne)</h2>
  <textarea id="playersInput" rows="4" placeholder="Alex
Marie"></textarea>
  <button id="startBtn" onclick="startGame()">ðŸš€ DÃ©marrer la partie</button>
  <p style="font-size:13px;color:#ddd;">Conseil : installez l'application (Partager â†’ Ajouter Ã  l'Ã©cran d'accueil) pour activer les notifications.</p>
</div>

<div id="game" style="display:none;">
  <div class="section card" style="text-align:left;">
    <p><strong>Joueur actuel :</strong> <span id="currentPlayer"></span></p>
    <label for="cardNumber">Choisir une carte (1 Ã  <span id="maxCards"></span>)</label>
    <input id="cardNumber" type="number" min="1" placeholder="1 - ...">
    <button id="seeBtn" onclick="pickCard()">Voir la carte choisie</button>
    <button id="randomBtn" onclick="randomCard()">Carte alÃ©atoire ðŸŽ²</button>
    <button id="passBtn" onclick="passCard()">Passe ðŸš«</button>
  </div>

  <div id="card" class="card" style="display:none;text-align:center;">
    <div id="cardIcon" class="icon"></div>
    <div id="cardText" style="font-size:18px;line-height:1.4;"></div>
    <button id="validateBtn" onclick="validateCard()">âœ… DÃ©fi validÃ©</button>
  </div>

  <div class="card" style="text-align:left;">
    <h3>Ajouter un dÃ©fi</h3>
    <textarea id="newCardText" rows="3" placeholder="Ã‰cris un dÃ©fi..."></textarea>
    <select id="newCardLevel">
      <option value="ðŸ”¥">Hot ðŸ”¥</option>
      <option value="ðŸ“¸">Photo ðŸ“¸</option>
    </select>
    <button id="addBtn" onclick="addCard()">âž• Ajouter</button>
  </div>

  <p id="message"></p>
</div>

<div class="footer">Rappelle-toi : consentement et respect avant chaque dÃ©fi.<br><small>Version v1.0.6</small><br>
<button id="testNotifBtn" onclick="testNotification()" style="font-size:12px;width:auto;padding:6px 10px;margin-top:8px;">ðŸ”” Tester notif</button>
</div>

<script>
// Cards data
let cards = [{"text": "Envoie une photo de ton jean entrouvert, main prÃªte Ã  descendre.", "icon": "ðŸ“¸"}, {"text": "Prends une photo oÃ¹ ta main glisse sous ton t-shirt, mais sâ€™arrÃªte juste avant.", "icon": "ðŸ“¸"}, {"text": "Capture une photo avec ton short/jupe tirÃ© un peu vers le bas, sans trop rÃ©vÃ©ler.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo dâ€™une serviette qui tient Ã  peine, prÃªte Ã  tomber.", "icon": "ðŸ“¸"}, {"text": "Prends une photo de ta main posÃ©e trÃ¨s bas sur ton ventre, proche de lâ€™interdit.", "icon": "ðŸ“¸"}, {"text": "Fais une photo de ta ceinture que tu dÃ©fais lentement.", "icon": "ðŸ“¸"}, {"text": "Capture une photo oÃ¹ tes doigts disparaissent sous un drap.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo oÃ¹ tu tires un peu sur le bord de ton sous-vÃªtement, sans montrer.", "icon": "ðŸ“¸"}, {"text": "Prends une photo de toi avec la chemise entrouverte, un bouton de trop dÃ©fait.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo oÃ¹ ta main remonte lentement le long de ta cuisse.", "icon": "ðŸ“¸"}, {"text": "Capture une photo dâ€™un drap qui glisse et dÃ©couvre juste assez.", "icon": "ðŸ“¸"}, {"text": "Prends une photo oÃ¹ tu es assis(e), jambes entrouvertes, main en attente.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo avec ton pantalon ouvert, comme si tu allais lâ€™enlever.", "icon": "ðŸ“¸"}, {"text": "Fais une photo oÃ¹ ta main se cache sous un tissu lÃ©ger.", "icon": "ðŸ“¸"}, {"text": "Capture une photo oÃ¹ tu joues avec la bordure de ton sous-vÃªtement.", "icon": "ðŸ“¸"}, {"text": "Prends une photo de toi allongÃ©(e), main trÃ¨s bas mais figÃ©e.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo oÃ¹ ton t-shirt est relevÃ© juste assez pour exciter.", "icon": "ðŸ“¸"}, {"text": "Capture une photo de ta main posÃ©e Ã  lâ€™intÃ©rieur de ta cuisse.", "icon": "ðŸ“¸"}, {"text": "Fais une photo de toi avec un vÃªtement Ã  moitiÃ© retirÃ©.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo comme si tu Ã©tais en train de te dÃ©shabiller, mais stoppÃ© Ã  temps.", "icon": "ðŸ“¸"}, {"text": "Pose ta main juste au-dessus de ta zone la plus intime et prends la photo.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo oÃ¹ ta main descend dangereusement bas sur ton ventre.", "icon": "ðŸ“¸"}, {"text": "Prends une photo de toi avec la ceinture entrouverte, comme si tu allais lâ€™enlever.", "icon": "ðŸ“¸"}, {"text": "Capture une photo oÃ¹ tu tires lÃ©gÃ¨rement sur ton short ou ta jupe pour laisser deviner.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo de ta main glissant lentement sous un drap.", "icon": "ðŸ“¸"}, {"text": "Prends une photo oÃ¹ tes doigts sâ€™arrÃªtent Ã  un souffle de lâ€™interdit.", "icon": "ðŸ“¸"}, {"text": "Montre une photo oÃ¹ ton pantalon ou jupe est entrouvert Ã  moitiÃ©.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo de ton ventre avec la main qui descend juste en dessous du nombril.", "icon": "ðŸ“¸"}, {"text": "Prends une photo de toi jouant avec la boucle de ta ceinture.", "icon": "ðŸ“¸"}, {"text": "Capture une photo oÃ¹ ta main disparaÃ®t sous un tissu lÃ©ger.", "icon": "ðŸ“¸"}, {"text": "Montre une photo oÃ¹ ton vÃªtement tombe sur une Ã©paule et ta main descend bas.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo oÃ¹ tu Ã©cartes lÃ©gÃ¨rement ton col ou ton t-shirt.", "icon": "ðŸ“¸"}, {"text": "Prends une photo de ton regard complice en posant la main trÃ¨s bas sur toi.", "icon": "ðŸ“¸"}, {"text": "Capture une photo en laissant deviner sous une serviette mal tenue.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo oÃ¹ ta main sâ€™approche de lâ€™intÃ©rieur de ta cuisse.", "icon": "ðŸ“¸"}, {"text": "Prends une photo de toi, bouton de jean dÃ©fait, main qui sâ€™approche.", "icon": "ðŸ“¸"}, {"text": "Montre une photo oÃ¹ ta main joue avec le bas de ton sous-vÃªtement (sans montrer).", "icon": "ðŸ“¸"}, {"text": "Envoie une photo avec un drap qui glisse bas et ta main qui lâ€™accompagne.", "icon": "ðŸ“¸"}, {"text": "Capture une photo de toi allongÃ©(e), main posÃ©e trÃ¨s bas sur le ventre.", "icon": "ðŸ“¸"}, {"text": "Prends une photo de toi assis(e), jambes entrouvertes, main qui attend.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo de ta bouche entrouverte, promettant un baiser.", "icon": "ðŸ“¸"}, {"text": "Prends une photo en contre-jour rÃ©vÃ©lant ta silhouette discrÃ¨te.", "icon": "ðŸ“¸"}, {"text": "Montre une courbe cachÃ©e sous un drap, juste une suggestion.", "icon": "ðŸ“¸"}, {"text": "Prends une photo floue en mouvement, pleine de mystÃ¨re.", "icon": "ðŸ“¸"}, {"text": "Envoie une photo de ton cou inclinÃ©, invitant Ã  un baiser.", "icon": "ðŸ“¸"}, {"text": "Photo : tes doigts jouant avec le col de ta chemise.", "icon": "ðŸ“¸"}, {"text": "Photo : une Ã©paule et la courbe du cou, lumiÃ¨re tamisÃ©e.", "icon": "ðŸ“¸"}, {"text": "Photo : toi prÃ¨s d'une fenÃªtre, silhouette discrÃ¨te.", "icon": "ðŸ“¸"}, {"text": "Photo : morsure lÃ©gÃ¨re de la lÃ¨vre, gros plan.", "icon": "ðŸ“¸"}, {"text": "Photo : dÃ©tail de la peau avec gouttes d'eau ou huile.", "icon": "ðŸ“¸"}, {"text": "Photo : main glissant sous une serviette (suggestion).", "icon": "ðŸ“¸"}, {"text": "Photo : chemise ouverte, sans montrer le reste.", "icon": "ðŸ“¸"}, {"text": "Photo : regard intense par-dessus les cheveux.", "icon": "ðŸ“¸"}, {"text": "Photo : profil, lumiÃ¨re tamisÃ©e, posture invitante.", "icon": "ðŸ“¸"}, {"text": "Photo : une jambe devinÃ©e sous un drap.", "icon": "ðŸ“¸"}, {"text": "Photo : nuque exposÃ©e, cheveux tombants.", "icon": "ðŸ“¸"}, {"text": "Photo : tenue grande ouverte sur une Ã©paule.", "icon": "ðŸ“¸"}, {"text": "Photo : accessoire (cravate, foulard) suggÃ©rant la tentation.", "icon": "ðŸ“¸"}, {"text": "Photo : fruit prÃ¨s de la bouche, style suggestif.", "icon": "ðŸ“¸"}, {"text": "Photo : enveloppÃ©(e) dans un drap, regard provocant.", "icon": "ðŸ“¸"}, {"text": "Fais un strip-tease lent en enlevant un vÃªtement.", "icon": "ðŸ”¥"}, {"text": "Embrasse passionnÃ©ment la personne de ton choix pendant 30s.", "icon": "ðŸ”¥"}, {"text": "Laisse ton/ta partenaire te bander les yeux et surprends-toi.", "icon": "ðŸ”¥"}, {"text": "Donne un massage sensuel de 5 minutes avec huile.", "icon": "ðŸ”¥"}, {"text": "Chuchote un fantasme Ã  l'oreille de ton/ta partenaire.", "icon": "ðŸ”¥"}, {"text": "Fais une danse trÃ¨s lente et sensuelle rien que pour lui/elle.", "icon": "ðŸ”¥"}, {"text": "Trace des baisers le long de la clavicule de ton/ta partenaire.", "icon": "ðŸ”¥"}, {"text": "Laisse ton/ta partenaire te guider les mains pendant 3 minutes.", "icon": "ðŸ”¥"}, {"text": "Attache lÃ©gÃ¨rement les mains de ton/ta partenaire avec une Ã©charpe.", "icon": "ðŸ”¥"}, {"text": "Fais un slow rapprochÃ©, poitrine contre poitrine.", "icon": "ðŸ”¥"}, {"text": "Donne une fessÃ©e coquine si l'autre est d'accord.", "icon": "ðŸ”¥"}, {"text": "Compose une phrase coquine et murmure-la au creux de l'oreille.", "icon": "ðŸ”¥"}, {"text": "Offre une dÃ©gustation sensuelle (fraise, chocolat) Ã  la bouche.", "icon": "ðŸ”¥"}, {"text": "Masse les cuisses en remontant trÃ¨s lentement vers les hanches.", "icon": "ðŸ”¥"}, {"text": "Improvise un jeu de rÃ´le pendant 5 minutes (petit scÃ©nario).", "icon": "ðŸ”¥"}, {"text": "Fais un cÃ¢lin prolongÃ©, respiration contre respiration.", "icon": "ðŸ”¥"}, {"text": "Montre une partie de ton corps prÃ©fÃ©rÃ©e pendant 5 secondes.", "icon": "ðŸ”¥"}, {"text": "Embrasse le cou, la nuque et remonte jusqu'Ã  l'oreille.", "icon": "ðŸ”¥"}, {"text": "Donne un baiser long puis arrÃªte-toi net pour crÃ©er la tension.", "icon": "ðŸ”¥"}, {"text": "Fais sentir un parfum sur ton cou et demande-lui de deviner.", "icon": "ðŸ”¥"}, {"text": "Ã‰cris un mot sexy sur sa peau avec ton doigt et laisse-le deviner.", "icon": "ðŸ”¥"}, {"text": "Fais tourner une bouteille et embrasse la personne dÃ©signÃ©e.", "icon": "ðŸ”¥"}, {"text": "Installe une ambiance : bougies, musique lente, lumiÃ¨re tamisÃ©e.", "icon": "ðŸ”¥"}, {"text": "Fais une performance privÃ©e (danse + jeu de regard) de 2 minutes.", "icon": "ðŸ”¥"}, {"text": "Explore une zone Ã©rogÃ¨ne nouvelle et dÃ©cris la sensation.", "icon": "ðŸ”¥"}, {"text": "Demande-lui de choisir une position et mime-la ensemble.", "icon": "ðŸ”¥"}, {"text": "Laisse une plume caresser sa peau pendant 1 minute.", "icon": "ðŸ”¥"}, {"text": "Tente un jeu d'endurance : reste immobile tactile pendant 2 minutes.", "icon": "ðŸ”¥"}, {"text": "Raconte une scÃ¨ne Ã©rotique que tu aimerais vivre avec lui/elle.", "icon": "ðŸ”¥"}, {"text": "Permets-lui de choisir un vÃªtement pour toi et porte-le immÃ©diatement.", "icon": "ðŸ”¥"}, {"text": "Donne un baiser sur chaque partie du visage (front, joue, bouche).", "icon": "ðŸ”¥"}, {"text": "Choisis un secret coquin Ã  rÃ©vÃ©ler aprÃ¨s le dÃ©fi.", "icon": "ðŸ”¥"}, {"text": "Fais une photo suggestive (Ã©tape suivante si acceptÃ© entre vous).", "icon": "ðŸ”¥"}, {"text": "Passe ta main sur sa poitrine doucement pendant 30s.", "icon": "ðŸ”¥"}, {"text": "EnlÃ¨ve lentement une chaussette, geste sensuel compris.", "icon": "ðŸ”¥"}, {"text": "Fais une danse collÃ©e-serrÃ©e en te dÃ©hanchant lentement.", "icon": "ðŸ”¥"}, {"text": "Chuchote cinq mots qui le/la rendent fou/folle.", "icon": "ðŸ”¥"}, {"text": "Fais un massage des pieds sensuel durant 3 minutes.", "icon": "ðŸ”¥"}, {"text": "Embrasse la personne Ã  gauche pendant 20 secondes.", "icon": "ðŸ”¥"}, {"text": "Prends une pose suggestive pour une photo non-explicite.", "icon": "ðŸ”¥"}, {"text": "Fais un bisou sur la hanche puis remonte vers la taille.", "icon": "ðŸ”¥"}, {"text": "Fais une dÃ©claration coquine, trÃ¨s directe, Ã  haute voix.", "icon": "ðŸ”¥"}, {"text": "Raconte ton souvenir le plus Ã©rotique avec cette personne.", "icon": "ðŸ”¥"}, {"text": "Fais un slow sur une musique choisie par l'autre.", "icon": "ðŸ”¥"}, {"text": "Offre un baiser volÃ© et puis un baiser prolongÃ©.", "icon": "ðŸ”¥"}, {"text": "Improvise une scÃ¨ne oÃ¹ tu le/la sÃ©duis comme au premier soir.", "icon": "ðŸ”¥"}, {"text": "Fais sentir une texture (soie, plume) sur sa peau les yeux bandÃ©s.", "icon": "ðŸ”¥"}, {"text": "Donne-lui 3 gages sexy Ã  choisir pour la suite.", "icon": "ðŸ”¥"}, {"text": "Propose un dÃ©fi chaud de 5 minutes choisi par l'autre.", "icon": "ðŸ”¥"}, {"text": "Fais une caresse prolongÃ©e sur la jambe interne pendant 1 min.", "icon": "ðŸ”¥"}, {"text": "Donne un bisou coquin sur la lÃ¨vre et mords lÃ©gÃ¨rement.", "icon": "ðŸ”¥"}, {"text": "Fais une mini performance: conte Ã©rotique de 1 minute.", "icon": "ðŸ”¥"}];
document.getElementById('maxCards').textContent = cards.length;

// State
let players = [];
let currentPlayerIndex = 0;
let currentCardIndex = null;

// Utility: show visual message
function showMessage(msg, color='#9ff') {
  const el = document.getElementById('message');
  if(!el) return;
  el.textContent = msg; el.style.color = color;
  setTimeout(()=>{ if(el) el.textContent = ''; }, 3000);
}

// Notifications - request permission on user gesture (start)
function safeNotify(msg) {
  try{
    if('Notification' in window && Notification.permission === 'granted') {
      new Notification('Jeu Coquin', { body: msg });
    }
  } catch(e){ console.warn('Notif error', e); }
  // visual fallback
  showMessage(msg, '#0f0');
}

function testNotification(){
  try{
    if('Notification' in window && Notification.permission !== 'granted') {
      Notification.requestPermission().then(function(p){ if(p==='granted'){ safeNotify('Test: notifications activÃ©es âœ…'); } else { showMessage('Notification refusÃ©e', 'red'); } });
    } else {
      safeNotify('Test de notification ðŸ””');
    }
  } catch(e){ showMessage('Impossible de tester la notif','red'); }
}

// Game functions
function startGame(){
  const input = document.getElementById('playersInput').value.trim();
  if(!input){ showMessage('Ajoute au moins un joueur !', 'red'); return; }
  players = input.split(/
+/).map(s=>s.trim()).filter(Boolean);
  if(players.length===0){ showMessage('Ajoute au moins un joueur !','red'); return; }
  document.getElementById('setup').style.display='none';
  document.getElementById('game').style.display='block';
  const cardNum = document.getElementById('cardNumber');
  if(cardNum){ cardNum.max = cards.length; cardNum.placeholder = '1 - ' + cards.length; }
  currentPlayerIndex = 0;
  updateCurrentPlayer();
  // Ask permission for notifications explicitly on start
  try{
    if('Notification' in window && Notification.permission !== 'granted'){
      Notification.requestPermission().then(p=>{
        if(p==='granted'){ showMessage('Notifications activÃ©es âœ…','#0f0'); }
        else{ showMessage('Notifications refusÃ©es','red'); }
      });
    }
  }catch(e){}
  // Ask for notification permission in a user gesture context
  try{ if('Notification' in window && Notification.permission !== 'granted'){ Notification.requestPermission().catch(()=>{}); } }catch(e){}
}

function updateCurrentPlayer(){ document.getElementById('currentPlayer').textContent = players[currentPlayerIndex]; }

function showCard(i){
  currentCardIndex = i;
  const c = cards[i];
  document.getElementById('cardText').textContent = c.text;
  document.getElementById('cardIcon').textContent = c.icon || 'ðŸ”¥';
  document.getElementById('card').style.display='block';
}

function pickCard(){
  const n = parseInt(document.getElementById('cardNumber').value, 10);
  if(isNaN(n) || n<1 || n>cards.length){ showMessage('Choisis un numÃ©ro entre 1 et ' + cards.length,'red'); return; }
  showCard(n-1);
}

function randomCard(){ showCard(Math.floor(Math.random()*cards.length)); }

function passCard(){ document.getElementById('card').style.display='none'; currentCardIndex = null; showMessage('DÃ©fi passÃ©.'); }

function validateCard(){
  if(currentCardIndex === null){ showMessage('Aucun dÃ©fi affichÃ©.','red'); return; }
  const player = players[currentPlayerIndex];
  safeNotify(player + ' a validÃ© son dÃ©fi !');
  showMessage(player + ' a validÃ© son dÃ©fi.','#0f0');
  currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
  updateCurrentPlayer();
  document.getElementById('card').style.display='none';
  currentCardIndex = null;
}

function addCard(){
  const text = document.getElementById('newCardText').value.trim();
  const level = document.getElementById('newCardLevel').value;
  if(text.length<4){ showMessage('Ã‰cris au moins 4 caractÃ¨res','red'); return; }
  cards.push({text:text, icon: level});
  document.getElementById('newCardText').value='';
  document.getElementById('maxCards').textContent = cards.length;
  showMessage('DÃ©fi ajoutÃ© !');
}
</script>
</body>
</html>
